# ===================================
# PRODUCTION Environment Configuration
# Self-Hosted LibreChat + Opik
# ===================================

# IMPORTANT: Generate strong passwords for all services!
# Use: openssl rand -hex 32

# ===================================
# Data Storage Path
# ===================================

# Where to store all data (must exist and have proper permissions)
DATA_PATH=/opt/librechat-opik/data

# Backup directory
BACKUP_PATH=/opt/librechat-opik/backups

# ===================================
# Opik Database Passwords
# ===================================

# MySQL
MYSQL_ROOT_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE
MYSQL_PASSWORD=CHANGE_ME_OPIK_DB_PASSWORD

# Redis
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD

# ClickHouse
CLICKHOUSE_PASSWORD=CHANGE_ME_CLICKHOUSE_PASSWORD

# MinIO
MINIO_ROOT_USER=opik_admin
MINIO_ROOT_PASSWORD=CHANGE_ME_MINIO_PASSWORD

# ===================================
# Opik Application Configuration
# ===================================

OPIK_VERSION=0.1.10

# Generate strong JWT secret: openssl rand -hex 64
OPIK_JWT_SECRET=CHANGE_ME_JWT_SECRET_64_CHARS

# Opik API Key (generate in Opik UI after first login)
OPIK_API_KEY=opik-production-key-change-after-setup

# Opik Project & Workspace
OPIK_PROJECT_NAME=librechat
OPIK_WORKSPACE_NAME=production

# Opik URLs (for production with domain)
# OPIK_FRONTEND_API_URL=https://opik.yourdomain.com/api
# OPIK_PYTHON_API_URL=https://opik.yourdomain.com/python-api

# CORS allowed origins (add your production domains)
ALLOWED_ORIGINS=https://chat.yourdomain.com,https://opik.yourdomain.com

# ===================================
# LibreChat Configuration
# ===================================

# MongoDB
MONGO_USERNAME=admin
MONGO_ROOT_PASSWORD=CHANGE_ME_MONGO_ROOT_PASSWORD

# LibreChat Security Keys (generate with: openssl rand -hex 32)
CREDS_KEY=CHANGE_ME_64_CHAR_HEX_STRING_HERE_USE_OPENSSL_RAND
CREDS_IV=CHANGE_ME_32_CHAR_HEX_STRING_HERE_USE_OPENSSL_RAND
LIBRECHAT_JWT_SECRET=CHANGE_ME_64_CHAR_HEX_STRING_HERE_USE_OPENSSL_RAND
LIBRECHAT_JWT_REFRESH_SECRET=CHANGE_ME_64_CHAR_HEX_STRING_HERE_USE_OPENSSL_RAND

# LLM API Keys
OPENAI_API_KEY=sk-your-production-openai-key
ANTHROPIC_API_KEY=sk-ant-your-production-anthropic-key
GOOGLE_API_KEY=your-production-google-key

# ===================================
# OpenTelemetry Configuration
# ===================================

ENABLE_OTEL=true
OTEL_SERVICE_NAME=librechat-backend-prod

# Debug (set to false in production)
DEBUG_LOGGING=false
OTEL_LOG_LEVEL=warn

# ===================================
# RAG Configuration
# ===================================

EMBEDDINGS_PROVIDER=openai
DEBUG_RAG_API=false

# ===================================
# Optional: External Services
# ===================================

# SMTP for email notifications (optional)
# SMTP_HOST=smtp.yourdomain.com
# SMTP_PORT=587
# SMTP_USER=noreply@yourdomain.com
# SMTP_PASSWORD=your-smtp-password
# SMTP_FROM=LibreChat <noreply@yourdomain.com>

# S3-compatible storage for attachments (optional)
# S3_ENDPOINT=https://s3.amazonaws.com
# S3_BUCKET=librechat-attachments
# S3_ACCESS_KEY=your-access-key
# S3_SECRET_KEY=your-secret-key

# ===================================
# Production Security Settings
# ===================================

# Session settings
SESSION_EXPIRY=900000  # 15 minutes
REFRESH_TOKEN_EXPIRY=604800000  # 7 days

# Rate limiting
LIMIT_CONCURRENT_MESSAGES=1
LIMIT_MESSAGE_IP=40
LIMIT_MESSAGE_USER=40

# Social login (disable in production if not used)
ALLOW_SOCIAL_LOGIN=false
ALLOW_SOCIAL_REGISTRATION=false

# ===================================
# SSL/TLS Configuration (if using nginx)
# ===================================

# SSL certificate paths (inside container)
# SSL_CERT_PATH=/etc/nginx/ssl/fullchain.pem
# SSL_KEY_PATH=/etc/nginx/ssl/privkey.pem

# ===================================
# Monitoring & Logging
# ===================================

# Syslog endpoint (optional)
# SYSLOG_HOST=logs.yourdomain.com
# SYSLOG_PORT=514

# Metrics endpoint (optional)
# PROMETHEUS_ENABLED=true
# PROMETHEUS_PORT=9090

# ===================================
# Backup Configuration
# ===================================

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# Backup schedule (cron format)
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM

# ===================================
# Quick Setup Checklist
# ===================================

# 1. Generate all passwords:
#    for i in {1..10}; do openssl rand -hex 32; done
#
# 2. Replace all CHANGE_ME values above
#
# 3. Create data directories:
#    sudo mkdir -p /opt/librechat-opik/{data,backups}
#    sudo chown -R $USER:$USER /opt/librechat-opik
#
# 4. Set proper permissions:
#    chmod 600 .env.production
#
# 5. Deploy:
#    docker compose -f docker-compose.yml -f docker-compose.prod.yml --profile opik --profile librechat up -d
#
# 6. Generate first API key in Opik UI
#
# 7. Update OPIK_API_KEY above and restart:
#    docker compose -f docker-compose.yml -f docker-compose.prod.yml --profile opik --profile librechat restart librechat-backend
